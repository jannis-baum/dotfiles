PLUGIN_DIR="$CONFIG_DIR/plugins"
SCRIPT_DIR="$CONFIG_DIR/scripts"

# bar appearance
bar=(
    position=top
    height=32
    notch_display_height=33
    color=0xff000000
    # as close to edge as possible
    padding_left=-9999
    padding_right=-9999
    topmost=on
)
sketchybar --bar "${bar[@]}"
sketchybar --load-font "$CONFIG_DIR/media/PoiretOne-With-Lightning.ttf"

# item defaults
default=(
  y_offset=1

  label.padding_left=12
  label.padding_right=12
  label.font="Poiret One:Bold:18"
  label.color=0xffbbbbbb
)
sketchybar --default "${default[@]}"

# reused props
label_color_alert="label.color=0xfffc897e"
label_font_symbol="label.font=SF Compact:Thin:14"

# invisible button that covers all empty space to hide briefly and show vanilla
# menubar (added first to be in background)
sketchybar --add item hide-button right \
           --set hide-button \
               width=9999 \
               click_script="$SCRIPT_DIR/hide-briefly.zsh"
# right items (always visible)
sketchybar --add item clock right \
           --set clock \
               update_freq=1 \
               script="$PLUGIN_DIR/clock.zsh" \
               click_script="$SCRIPT_DIR/show-control-center.zsh" \
           --subscribe clock mouse.entered mouse.exited \
sketchybar --add item battery right \
           --set battery \
               update_freq=10 \
               script="$PLUGIN_DIR/battery.zsh" \
           --subscribe battery mouse.entered mouse.exited power_source_change \
# right items (visible if important information)
sketchybar --add item volume right \
           --set volume \
               "$label_font_symbol" \
               script="$PLUGIN_DIR/volume.zsh" \
               click_script="$SCRIPT_DIR/mute.zsh" \
           --subscribe volume volume_change
sketchybar --add item remote right \
           --set remote \
               update_freq=1 \
               "$label_font_symbol" \
               "$label_color_alert" \
               script="$PLUGIN_DIR/remote.zsh" \
               click_script="$SCRIPT_DIR/disconnect-remote.zsh"
sketchybar --add item cpu_busy right \
           --set cpu_busy \
               update_freq=1 \
               "$label_color_alert" \
               script="$PLUGIN_DIR/cpu-busy.zsh" \
           --subscribe cpu_busy mouse.entered mouse.exited

# left app indicator if no tabs
sketchybar --add event tabs_updated
sketchybar --add item front_app left \
           --set front_app \
                script="$PLUGIN_DIR/front_app.zsh" \
                label.font=Menlo:Bold:14 \
           --subscribe front_app front_app_switched tabs_updated

# update all items
sketchybar --update

# init sketchytabs
$SCRIPT_DIR/init-sketchytabs.zsh
