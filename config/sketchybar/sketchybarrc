PLUGIN_DIR="$CONFIG_DIR/plugins"
SCRIPT_DIR="$CONFIG_DIR/scripts"

# bar appearance
bar=(
    position=top
    height=32
    color=0xff000000
    # as close to edge as possible
    padding_left=-9999
    padding_right=-9999
    topmost=on
)
sketchybar --bar "${bar[@]}"
sketchybar --load-font "$CONFIG_DIR/media/PoiretOne-With-Lightning.ttf"

# item defaults
default=(
  y_offset=1

  label.padding_left=12
  label.padding_right=12
  label.font="Poiret One:Bold:18"
  label.color=0xffbbbbbb
)
sketchybar --default "${default[@]}"

# right items (always visible)
sketchybar --add item clock right \
           --set clock update_freq=1 script="$PLUGIN_DIR/clock.zsh" \
           --subscribe clock mouse.entered mouse.exited \
           --set clock click_script="$SCRIPT_DIR/show-control-center.zsh"
sketchybar --add item battery right \
           --set battery update_freq=10 script="$PLUGIN_DIR/battery.zsh" \
           --subscribe battery mouse.entered mouse.exited power_source_change \
           --set battery click_script="$SCRIPT_DIR/hide-briefly.zsh"
# right items (visible if important information)
sketchybar --add item cpu_busy right \
           --set cpu_busy update_freq=1 script="$PLUGIN_DIR/cpu-busy.zsh" \
               label.color=0xfffc897e \
           --subscribe cpu_busy mouse.entered mouse.exited
sketchybar --add item tunnelblick right \
           --set tunnelblick \
               update_freq=1 \
               label.font="SF Compact:Thin:14" \
               script="$PLUGIN_DIR/tunnelblick.zsh" \
               click_script="$SCRIPT_DIR/show-tunnelblick-menu.zsh"

# left app indicator if no tabs
sketchybar --add event tabs_updated
sketchybar --add item front_app left \
           --set front_app \
                script="$PLUGIN_DIR/front_app.zsh" \
                label.font=Menlo:Bold:14 \
           --subscribe front_app front_app_switched tabs_updated

# update all items
sketchybar --update

# init sketchytabs
$SCRIPT_DIR/init-sketchytabs.zsh
